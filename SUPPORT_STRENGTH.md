# 支撐強度相對比較功能

## 概述

新增的 `SupportStrengthAnalyzer` 模組可計算每個價位的支撐/壓力強度,並進行相對比較排名。

## 計算方法

### 1. 基礎強度 (Volume-Based)
- **成交量權重**: 成交量越大的價位,支撐強度越強
- **公式**: `基礎分數 = 該價位成交量`

### 2. 歷史反彈調整 (Bounce Factor)
- **觸碰次數**: 價格在該區間附近反彈的次數
- **容差**: ±0.2% 價格範圍
- **權重**: 每次觸碰增加 10% 強度
- **公式**: `調整後分數 = 基礎分數 × (1 + 觸碰次數 × 0.1)`

### 3. 距離衰減 (Distance Decay)
- **重要性**: 距離當前價格越近,重要性越高
- **衰減函數**: 指數衰減 `e^(-5 × 距離比率)`
- **公式**: `最終分數 = 調整後分數 × e^(-5 × |價格-當前價| / 當前價)`

### 4. 標準化與排名
- **Z-Score**: 標準化分數,顯示相對偏離程度
- **Min-Max 標準化**: 轉換為 0-100 分數
- **過濾**: 保留 Top 30% 的強支撐位
- **排名**: 分數越高排名越前 (#1 最強)

## 輸出結果

### Support Strength Ranking 表格包含:

| 欄位 | 說明 |
|------|------|
| **Rank** | 排名 (#1 = 最強支撐) |
| **Price** | 價位 (自動標註 POC/VAH/VAL) |
| **Strength Score** | 標準化強度分數 (0-100) + 視覺化條形圖 |
| **Z-Score** | 統計標準化分數 |
| **Distance** | 距離當前價格的百分比 |

## 使用範例

```bash
# 預設設定 (5天, 150個價格區間)
python main.py

# 自訂分析週期和解析度
python main.py --period 10d --bins 200

# 分析其他商品 (黃金)
python main.py --symbol GC=F
```

## 實戰應用

### 1. 識別關鍵支撐位
- **Top 3 排名**: 最強的支撐/壓力區域
- **POC 附近**: 均值回歸機會
- **VAH/VAL 附近**: 突破/跌破觀察點

### 2. 期權策略選擇
- **高分數區域 (80-100)**: 
  - 賣出勒式策略 (Short Strangle)
  - 鐵鷹策略 (Iron Condor)
  
- **中分數區域 (50-80)**:
  - 信用價差 (Credit Spread)
  - 價差組合 (Spread)

- **低分數區域 (<50)**:
  - 避免賣出選擇權
  - 考慮買入突破策略

### 3. 風險管理
- **Distance 欄位**: 評估距離風險
  - > ±5%: 較遠,短期影響小
  - ±2-5%: 中期關注區
  - < ±2%: 立即關注,可能測試

## 技術細節

### 核心檔案
- `/core/support_strength.py`: 強度計算引擎
- `/main.py`: 整合顯示邏輯

### 依賴套件
- `scipy`: Z-score 標準化
- `pandas`: 資料處理
- `numpy`: 數學計算

### 效能
- 計算時間: < 1秒 (5天資料)
- 記憶體: < 50MB

## 未來改進方向

1. **機器學習增強**:
   - 使用 Random Forest 預測支撐強度
   - 結合更多特徵 (波動率、成交量變化等)

2. **視覺化**:
   - 價格圖表上標註支撐位
   - 強度熱力圖

3. **回測驗證**:
   - 歷史準確率統計
   - 勝率/盈虧比分析

4. **即時監控**:
   - 價格接近強支撐位時發送警報
   - WebSocket 即時更新

---

**作者**: Dev Bot 3 (workspace-dev-3)  
**日期**: 2025-02-11  
**版本**: 1.0.0
